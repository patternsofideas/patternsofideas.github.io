<!DOCTYPE html>
<head>
  <meta charset="utf-8"/>
  <title>Asymptotic Normality of U-Statistics &mdash; Patterns of Ideas</title>
  <link rel="stylesheet" type="text/css" href="/static/tufte.css">
  <link rel="stylesheet" type="text/css" href="/static/latex.min.css">
  <link rel="stylesheet" type="text/css" href="/static/pygments.min.css">
  <script type="text/javascript" src="/static/enquire.min.js"></script>
  <script type="text/javascript" src="/static/jquery-1.12.4.min.js"></script>
  <script type="text/javascript" src="/static/resources.min.js"></script>
  <script type="text/javascript" src="/static/LaTeXMathML.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel='shortcut icon' href="/static/favicon.ico" type='image/x-icon'/>
  <style type="text/css">
   img { mix-blend-mode: multiply; }
  </style>
  <meta property="og:author" content="Samir Khan" />
  <meta property="og:title" content="Asymptotic Normality of U-Statistics" />
  <meta property="og:type" content="website" />
  <meta property="og:description" content="Some notes on u-statistics and their asymptotic normality." />
  <meta property="og:url" content="/posts/ustat/" />
  <meta property="og:image" content="/static/img/athena.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Asymptotic Normality of U-Statistics" />
  <meta name="twitter:description" content="Some notes on u-statistics and their asymptotic normality." />
  <meta name="twitter:url" content="/posts/ustat/" />
  <meta name="twitter:image" content="/static/img/athena.png" />
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
  <div class="thearticle">

  <article>
  
    <h1>Asymptotic Normality of U-Statistics</h1>
    <p id="blog-p"><span id="blogdesc" class="marginnote">
    A personal blog by Samir Khan<br><br>
    <a href="/">home</a> Â·
    
      <a href="/about/">
        about</a>
    </span></p>

    <subtitle class="sub-date">August 20, 2018 Â· <span style="font-size: 1.6rem;"><a style="border-bottom-width: 0px !important;" href="/posts/ustat/">&infin;</a></span></subtitle>

    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<p>These are some notes on the proof that U-statistics are asymptotically normal, mostly drawn from Van der Vaartâ€™s <em>Asymptotic Statistics</em> but also partially from an appendix of Lehmannâ€™s <em>Statistical Methods Based on Ranks</em>.</p>
<h2 id="what-is-a-u-statistic">1. What is a U-Statistic?</h2>
<p>Consider <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><mi>â‹¯</mi><mo>,</mo><msub><mi>X</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">X_1,\cdots, X_n</annotation></semantics></math> i.i.d. from some distribution. When we want to estimate a parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\theta = \mathbb{E}[f(X_i)]</annotation></semantics></math>, we look at <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>â‹¯</mi><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><mi>n</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\frac{f(X_1)+\cdots +f(X_n)}{n}.</annotation></semantics></math> This is an unbiased estimate of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[f(X_i)]</annotation></semantics></math> and asymptotically normal by the CLT. If we wanted instead to estimate a parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\theta = \mathbb{E}[f(X_i, X_j)]</annotation></semantics></math>, we might try something like <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>â‹¯</mi><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>X</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><mi>n</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\frac{f(X_1, X_2)+\cdots + f(X_{n-1}, X_n)}{n}.</annotation></semantics></math> This doesnâ€™t quite make sense though: why donâ€™t we care about <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>3</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(X_1, X_3)</annotation></semantics></math>? what if <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>â‰ </mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>2</mn></msub><mo>,</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(X_1, X_2)\neq f(X_2, X_1)</annotation></semantics></math>? We can fix these problems by requiring that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> be symmetric and working with <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mn>2</mn></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></munder><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">U=\binom{n}{2}^{-1}\sum_{i&lt;j} f(X_i, X_j)</annotation></semantics></math> instead, but a bigger problem is that the terms of this sum are not independent. This means we cannot directly apply the CLT, and so asymptotic normality is up in the air. This turns out to only be a technical issue though, in the sense that we still have asymptotic normality, but it just requires more effort to show.</p>
<h2 id="asymptotic-normality">2. Asymptotic Normality</h2>
<p>The the key idea is to project <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math> onto things we can apply the CLT to, namely things of the form <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\sum_{i=1}^n g_i(X_i)</annotation></semantics></math>. Assume for convenience that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta=0</annotation></semantics></math>.</p>
<h3 id="choosing-a-projection">2.1 Choosing a projection</h3>
<p><em>Claim</em>. The projection of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math> onto the set of sums described above is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>U</mi><mo accent="true">^</mo></mover><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>U</mi><mo>âˆ£</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\hat{U}=\sum_{i=1}^n \mathbb{E}[U\mid X_i]</annotation></semantics></math>.</p>
<p><em>Proof.</em> We show <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>U</mi><mo accent="true">^</mo></mover><mo>âˆ’</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">\hat{U}-U</annotation></semantics></math> is orthogonal to any function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>j</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g_j(X_j)</annotation></semantics></math>. Fix <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>, and note that <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo>âˆ£</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">]</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>U</mi><mo>âˆ£</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">]</mo><mo>âˆ£</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">]</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}[\hat{U}\mid X_j]=\sum_{i=1}^n \mathbb{E}[\mathbb{E}[U\mid X_i]\mid X_j].</annotation></semantics></math> In this sum, if <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>â‰ </mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i\neq j</annotation></semantics></math>, then <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">X_i, X_j</annotation></semantics></math> are independent and we get <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>U</mi><mo>âˆ£</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">]</mo><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>U</mi><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[\mathbb{E}[U\mid X_i]]=\mathbb{E}[U]=0</annotation></semantics></math>. If <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i=j</annotation></semantics></math>, we get <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>U</mi><mo>âˆ£</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[U\mid X_j]</annotation></semantics></math>. Thus the entire sum is just <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>U</mi><mo>âˆ£</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[U\mid X_j]</annotation></semantics></math>.</p>
<p>With this in mind, we compute <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mo stretchy="false" form="prefix">(</mo><mi>U</mi><mo>âˆ’</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="postfix">)</mo><msub><mi>g</mi><mi>j</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mo stretchy="false" form="prefix">(</mo><mi>U</mi><mo>âˆ’</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="postfix">)</mo><msub><mi>g</mi><mi>j</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>âˆ£</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">]</mo><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>U</mi><mo>âˆ’</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo>âˆ£</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">]</mo><msub><mi>g</mi><mi>j</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">]</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}[(U-\hat{U})g_j(X_j)]=\mathbb{E}[\mathbb{E}[(U-\hat{U})g_j(X_j)\mid X_j]]=\mathbb{E}[\mathbb{E}[U-\hat{U}\mid X_j]g_j(X_j)].</annotation></semantics></math> The inner expectation is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>U</mi><mo>âˆ£</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">]</mo><mo>âˆ’</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo>âˆ£</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[U\mid X_j]-\mathbb{E}[\hat{U}\mid X_j]=0</annotation></semantics></math> by the argument above, and so the entire inner product is as well. The desired orthogonality, and thus the claim, follows.</p>
<p>As mentioned above, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>U</mi><mo accent="true">^</mo></mover><annotation encoding="application/x-tex">\hat{U}</annotation></semantics></math> is asymptotically normal by CLT<span><label for="sn-1" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-1" class="margin-toggle"/><span class="sidenote">Actually, we need to make sure that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>U</mi><mo accent="true">^</mo></mover><annotation encoding="application/x-tex">\hat{U}</annotation></semantics></math> has finite variance and some scaling, but weâ€™ll see this along the way.<br />
<br />
</span></span>. To get the asymptotic normality of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math> from this, we need to show that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>U</mi><mo accent="true">^</mo></mover><mo accent="false">â†’</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">\hat{U}\to U</annotation></semantics></math> in distribution. Weâ€™ll actually show the stronger fact that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>âˆ’</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo accent="false">â†’</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U-\hat{U}\to 0</annotation></semantics></math> in probability, by way of a lemma.</p>
<h3 id="a-technical-lemma">2.2 A technical lemma</h3>
<p><em>Lemma.</em> If <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{T}_n</annotation></semantics></math> is the projection of a sequence of mean zero random variables <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>n</mi></msub><annotation encoding="application/x-tex">T_n</annotation></semantics></math> onto a linear space <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math> containing the constants, then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow></mfrac><mo accent="false">â†’</mo><mn>1</mn><mo accent="false">âŸ¹</mo><mfrac><msub><mi>T</mi><mi>n</mi></msub><msqrt><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow></msqrt></mfrac><mo>âˆ’</mo><mfrac><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><msqrt><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow></msqrt></mfrac><mo accent="false">â†’</mo><mn>0</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">\frac{\text{var}(T_n)}{\text{var}(\hat{T}_n)}\to 1\implies \frac{T_n}{\sqrt{\text{var}(T_n)}}-\frac{\hat{T}_n}{\sqrt{\text{var}(\hat{T}_n)}}\to 0,</annotation></semantics></math> in probability.</p>
<p><em>Proof.</em> We actually show convergence in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>L</mi><mn>2</mn></msup><annotation encoding="application/x-tex">L^2</annotation></semantics></math>, and we do this by showing convergence of the mean and variance. The mean is always zero, so we get that for free. The variance is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>âˆ’</mo><mn>2</mn><mfrac><mrow><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>n</mi></msub><mo>,</mo><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><msqrt><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow></msqrt></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">2-2\frac{\text{cov}(T_n, \hat{T}_n)}{\sqrt{\text{var}(T_n)\text{var}(\hat{T}_n)}}.</annotation></semantics></math> That numerator is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><msub><mi>T</mi><mi>n</mi></msub><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><mo stretchy="false" form="postfix">]</mo><mo>âˆ’</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><msub><mi>T</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">]</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><mo stretchy="false" form="postfix">]</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}[T_n\hat{T}_n]-\mathbb{E}[T_n]\mathbb{E}[\hat{T}_n].</annotation></semantics></math> Since <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{T}_n</annotation></semantics></math> is a projection of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>n</mi></msub><annotation encoding="application/x-tex">T_n</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>n</mi></msub><mo>âˆ’</mo><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">T_n-\hat{T}_n</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{T}_n</annotation></semantics></math> are orthogonal, making the first term equal to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><msubsup><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi><mn>2</mn></msubsup><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[\hat{T}_n^2]</annotation></semantics></math>. Since the space <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math> contains the constants, we have that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><msub><mi>T</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[T_n]=\mathbb{E}[\hat{T}_n]</annotation></semantics></math> (otherwise we could shift <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{T}_n</annotation></semantics></math> by a constant to de-bias it, and find an element of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math> that is closer to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>n</mi></msub><annotation encoding="application/x-tex">T_n</annotation></semantics></math>, contradicting the fact that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{T}_n</annotation></semantics></math> is the projection of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>n</mi></msub><annotation encoding="application/x-tex">T_n</annotation></semantics></math> onto <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>). Combining these, the numerator is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{var}(\hat{T}_n)</annotation></semantics></math>, and so the entire fraction is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mfrac><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>T</mi><mo accent="true">^</mo></mover><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow></mfrac></msqrt><mi>.</mi></mrow><annotation encoding="application/x-tex">\sqrt{\frac{\text{var}(\hat{T}_n)}{\text{var}(T_n)}}.</annotation></semantics></math> This goes to 1 by hypothesis, so the variance goes to zero, giving the result.</p>
<p>The rest of the proof amounts to checking that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>U</mi><mo accent="true">^</mo></mover><mo>,</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">\hat{U}, U</annotation></semantics></math> satisfy the hypothesis of this lemma by computing their variances. We start with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>U</mi><mo accent="true">^</mo></mover><annotation encoding="application/x-tex">\hat{U}</annotation></semantics></math>.</p>
<h3 id="computing-textvarhatu">2.3 Computing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{var}(\hat{U})</annotation></semantics></math></h3>
<p>Consider one term of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>U</mi><mo accent="true">^</mo></mover><annotation encoding="application/x-tex">\hat{U}</annotation></semantics></math>, like <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>âˆ£</mo><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mi>x</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[f(X_i, X_j)\mid X_1=x]</annotation></semantics></math>. If <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i=1</annotation></semantics></math> or <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j=1</annotation></semantics></math>, this is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[f(x, X_j)]=\mathbb{E}[f(X_i, x)]</annotation></semantics></math>. Otherwise, itâ€™s zero (since we assumed that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta=0</annotation></semantics></math>). The first case happens in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math> terms of the sum defining <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math>, and there are <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mn>2</mn></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\binom{n}{2}</annotation></semantics></math> total terms, so we get an average of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mi>n</mi><mn>2</mn></mfrac><annotation encoding="application/x-tex">\frac{n}{2}</annotation></semantics></math> terms, each contributing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\hat{f}(x)=\mathbb{E}[(f(x, X_2)]</annotation></semantics></math>. Doing this for all the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>, we get <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>U</mi><mo accent="true">^</mo></mover><mo>=</mo><mfrac><mn>2</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mover><mi>f</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo accent="false">âŸ¹</mo><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mfrac><mn>4</mn><mi>n</mi></mfrac><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mover><mi>f</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\hat{U} = \frac{2}{n} \sum_{i=1}^n \hat{f}(X_i) \implies \text{var}(\hat{U})=\frac{4}{n}\text{var}(\hat{f}(X_1)).</annotation></semantics></math></p>
<p>Next, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">var</mtext><mrow><mo stretchy="false" form="prefix">(</mo><mover><mi>f</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><mo>=</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mover><mi>f</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo stretchy="false" form="postfix">]</mo><mo>âˆ’</mo><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mover><mi>f</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><msup><mo stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">\text{var}{(\hat{f}(X_1))}=\mathbb{E}[\hat{f}(X_1)^2]-\mathbb{E}[\hat{f}(X_1)]^2.</annotation></semantics></math> Note that these expectations are over the choice of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>, whereas the expectations in the definition of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>f</mi><mo accent="true">^</mo></mover><annotation encoding="application/x-tex">\hat{f}</annotation></semantics></math> are over the choice of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>. When applied successively, the result is that we just take an expectation over both. In the first term, this gives <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[f(X_1, X_2)^2]=\text{cov}(f(X_1, X_2), f(X_1, X_2)),</annotation></semantics></math> since we made the assumption that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta=0</annotation></semantics></math>. In the second it gives <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathvariant="double-struck"><mi>ğ”¼</mi></mstyle><mo stretchy="false" form="prefix">[</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><msup><mo stretchy="false" form="postfix">]</mo><mn>2</mn></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[f(X_1, X_2)]^2=0</annotation></semantics></math> for the same reason. Plugging back in, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mfrac><mrow><mn>4</mn><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><mi>n</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\text{var}(\hat{U})=\frac{4\text{cov}(f(X_1, X_2), f(X_1, X_2))}{n}.</annotation></semantics></math></p>
<h3 id="computing-textvaru">2.4 Computing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mi>U</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{var}(U)</annotation></semantics></math></h3>
<p>Now we turn to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">var</mtext><mrow><mo stretchy="false" form="prefix">(</mo><mi>U</mi><mo stretchy="false" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{var}{(U)}</annotation></semantics></math>. Written explicitly, it is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mn>2</mn></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>2</mn></mrow></msup><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></munder><munder><mo>âˆ‘</mo><mrow><mi>k</mi><mo>,</mo><mi>l</mi></mrow></munder><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>k</mi></msub><mo>,</mo><msub><mi>X</mi><mi>l</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\binom{n}{2}^{-2}\sum_{i,j} \sum_{k,l} \text{cov}(f(X_i, X_j), f(X_k, X_l)).</annotation></semantics></math> Because <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math> is symmetric, the value of the covariance depends only on how many elements <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{i,j\}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{k,l\}</annotation></semantics></math> have in common. Thus we identify three kinds of terms:</p>
<ul>
<li>terms with no elements in common, of which there are <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mn>2</mn></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mrow><mi>n</mi><mo>âˆ’</mo><mn>2</mn></mrow><mn>2</mn></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\binom{n}{2}\binom{n-2}{2}</annotation></semantics></math>, each contributing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">cov</mtext><mrow><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>k</mi></msub><mo>,</mo><msub><mi>X</mi><mi>l</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{cov}{(f(X_i, X_j), f(X_k, X_l))}=0</annotation></semantics></math> (because the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math> are independent),</li>
<li>terms with one element in common, of which there are <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mn>2</mn></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‹…</mo><mn>2</mn><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\binom{n}{2}\cdot 2(n-2)</annotation></semantics></math> (choose the first pair, choose the element to duplicate, choose the other element of the other pair), each contributing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{cov}(f(X_i, X_j), f(X_i, X_k))</annotation></semantics></math>,</li>
<li>terms with both elements in common, of which there are <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mn>2</mn></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\binom{n}{2}</annotation></semantics></math>, each contributing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{var}(f(X_i, X_j))</annotation></semantics></math>.</li>
</ul>
<p>Putting it all together and distributing in the binomial coefficient, we have <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mi>U</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>2</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mn>2</mn></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false" form="postfix">)</mo><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mn>2</mn></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">\text{var}(U)=2\binom{n}{2}^{-1}(n-2)\text{cov}(f(X_i, X_j), f(X_i, X_k))+\binom{n}{2}^{-1}\text{var}(f(X_i, X_j)),</annotation></semantics></math> and equivalently <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">var</mtext><mrow><mo stretchy="false" form="prefix">(</mo><mi>U</mi><mo stretchy="false" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mn>4</mn><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false" form="postfix">)</mo><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><mrow></mrow></mfrac><mo>+</mo><mfrac><mrow><mn>2</mn><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><mrow><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false" form="postfix">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{var}{(U)}=\frac{4(n-2)\text{cov}(f(X_i, X_j), f(X_i, X_k))}{}+\frac{2\text{var}(f(X_i, X_j))}{n(n-2)}</annotation></semantics></math></p>
<h3 id="combining-and-concluding">2.5 Combining and concluding</h3>
<p>Combining our expressions, we find <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mi>U</mi><mo stretchy="false" form="postfix">)</mo></mrow><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mover><mi>U</mi><mo accent="true">^</mo></mover><mo stretchy="false" form="postfix">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false" form="postfix">)</mo><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><mrow><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow></mfrac><mo>+</mo><mfrac><mrow><mtext mathvariant="normal">var</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><mrow><mn>2</mn><mtext mathvariant="normal">cov</mtext><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false" form="postfix">)</mo></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\frac{\text{var}(U)}{\text{var}(\hat{U})}=\frac{n(n-2)\text{cov}(f(X_i, X_j), f(X_i, X_k))}{\text{cov}(f(X_1, X_2), f(X_1, X_2))n(n-1)}+\frac{\text{var}(f(X_i, X_j))}{2\text{cov}(f(X_1, X_2), f(X_1, X_2))(n-2)}.</annotation></semantics></math> The first term goes to 1 and the second goes to 0, so we have the result.</p>
<h2 id="extensions">3. Extensions</h2>
<p>The result outlined here can be made more general in several ways. One is to let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> be a function of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">r&gt;2</annotation></semantics></math> variables, and define <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mi>r</mi></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>âˆ‘</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><msub><mi>a</mi><mn>1</mn></msub></msub><mo>,</mo><mi>â‹¯</mi><mo>,</mo><msub><mi>X</mi><msub><mi>a</mi><mi>r</mi></msub></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">U=\binom{n}{r}^{-1}\sum f(X_{a_1},\cdots, X_{a_r}),</annotation></semantics></math> where the sum is taken over all subsets <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><mi>â‹¯</mi><mo>,</mo><msub><mi>a</mi><mi>r</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{a_1,\cdots, a_r\}</annotation></semantics></math> of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â‹¯</mi><mo>,</mo><mi>n</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1,\cdots, n\}</annotation></semantics></math>. Another is to consider getting a sample of two variables <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>â‹¯</mi><mo>,</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X_1, Y_1),\cdots, (X_n, Y_n)</annotation></semantics></math> and look at <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>m</mi><mi>r</mi></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mstyle linethickness="0"><mfrac><mi>n</mi><mi>s</mi></mfrac></mstyle><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>âˆ‘</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>X</mi><msub><mi>a</mi><mn>1</mn></msub></msub><mo>,</mo><mi>â‹¯</mi><mo>,</mo><msub><mi>X</mi><msub><mi>a</mi><mi>r</mi></msub></msub><mo>,</mo><msub><mi>Y</mi><msub><mi>b</mi><mn>1</mn></msub></msub><mo>,</mo><mi>â‹¯</mi><mo>,</mo><msub><mi>Y</mi><msub><mi>b</mi><mi>s</mi></msub></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">U=\binom{m}{r}^{-1}\binom{n}{s}^{-1}\sum f(X_{a_1}, \cdots, X_{a_r}, Y_{b_1},\cdots, Y_{b_s}),</annotation></semantics></math> where the sums are indexed over the appropriate subsets. Statistics of these forms have asymptotic normality results as well, and the proofs go along basically the same lines.</p>
</body>
</html>

  
  </article>

  </div>
  <div class="thefooter">
    <p>Made with Athena
    <br><br>Copyright, <i>2016</i></p>
  </div> <!-- footer end -->
</body>
</html>